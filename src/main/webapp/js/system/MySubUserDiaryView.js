Ext.ns("MySubUserDiaryView");var MySubUserDiaryView=function(){return new Ext.Panel({id:"MySubUserDiaryView",title:"下属工作日志",iconCls:"menu-subDiary",autoScroll:true,items:[new Ext.FormPanel({height:40,frame:false,border:false,id:"MySubUserDiarySearchForm",layout:"hbox",layoutConfig:{padding:"5",align:"middle"},defaults:{xtype:"label",margins:{top:0,right:4,bottom:4,left:4}},items:[{text:"请输入查询条件:"},{text:"下属姓名"},{hiddenName:"userId",emptyText:"请选择",xtype:"combo",mode:"local",anchor:"98%",editable:false,valueField:"id",displayField:"name",triggerAction:"all",store:new Ext.data.SimpleStore({autoLoad:true,url:__ctxPath+"/system/comboUserSub.do",fields:["id","name"]})},{xtype:"button",text:"查询",iconCls:"search",handler:function(){var a=Ext.getCmp("MySubUserDiarySearchForm");var b=Ext.getCmp("MySubUserDiaryGrid");if(a.getForm().isValid()){$search({searchPanel:a,gridPanel:b});}}},{xtype:"button",text:"重置",iconCls:"search",handler:function(){var a=Ext.getCmp("MySubUserDiarySearchForm");a.getForm().reset();}}]}),this.setup()]});};MySubUserDiaryView.prototype.setup=function(){return this.grid();};MySubUserDiaryView.prototype.grid=function(){var a=new Ext.grid.ColumnModel({columns:[new Ext.grid.RowNumberer(),{header:"diaryId",dataIndex:"diaryId",hidden:true},{header:"姓名",dataIndex:"userName"},{header:"日期",dataIndex:"dayTime"},{header:"管理",dataIndex:"diaryId",width:100,renderer:function(g,f,d,j,e){var i=d.data.diaryId;var h='<button title="查看" value=" " class="btn-readdocument" onclick="MySubUserDiaryView.check('+i+')">&nbsp;</button>';return h;}}],defaults:{sortable:true,menuDisabled:false,width:100}});var b=this.store();b.load({params:{start:0,limit:10}});var c=new Ext.grid.GridPanel({id:"MySubUserDiaryGrid",store:b,trackMouseOver:true,disableSelection:false,loadMask:true,autoHeight:true,cm:a,viewConfig:{forceFit:true,enableRowBody:false,showPreview:false},bbar:new Ext.PagingToolbar({pageSize:10,store:b,displayInfo:true,displayMsg:"当前显示从{0}至{1}， 共{2}条记录",emptyMsg:"当前没有记录"})});c.addListener("rowdblclick",function(f,d,g){f.getSelectionModel().each(function(e){MySubUserDiaryView.check(e.data.diaryId);});});return c;};MySubUserDiaryView.prototype.store=function(){var a=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:__ctxPath+"/system/subUserDiary.do"}),reader:new Ext.data.JsonReader({root:"result",totalProperty:"totalCounts",id:"id",fields:[{name:"diaryId",type:"int"},"dayTime","content","diaryType",{name:"userName",mapping:"appUser.fullname"}]}),remoteSort:true});a.setDefaultSort("diaryId","desc");return a;};MySubUserDiaryView.check=function(a){new DiaryDetail(a);};